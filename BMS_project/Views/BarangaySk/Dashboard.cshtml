@{
    Layout = "~/Views/Shared/_BarangayLayout.cshtml";
    ViewData["Title"] = "Dashboard";
}

<div class="container-fluid py-4">
    <!-- HEADER -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h3 class="fw-bold text-primary mb-0">SK Barangay Dashboard</h3>
        <small class="text-muted">Last updated: @DateTime.Now.ToString("MMMM dd, yyyy")</small>
    </div>

    <!-- KPI CARDS -->
    <div class="row g-4 mb-4">
        <div class="col-md-3">
            <div class="card text-center border-0 shadow-sm">
                <div class="card-body">
                    <h6 class="fw-semibold text-secondary mb-1">Total Youth Registered</h6>
                    <h3 class="fw-bold mb-0 text-primary">1,245</h3>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-center border-0 shadow-sm">
                <div class="card-body">
                    <h6 class="fw-semibold text-secondary mb-1">Approved Projects</h6>
                    <h3 class="fw-bold mb-0 text-success">8</h3>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-center border-0 shadow-sm">
                <div class="card-body">
                    <h6 class="fw-semibold text-secondary mb-1">Pending Reports</h6>
                    <h3 class="fw-bold mb-0 text-warning">3</h3>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-center border-0 shadow-sm">
                <div class="card-body">
                    <h6 class="fw-semibold text-secondary mb-1">Audit Flags</h6>
                    <h3 class="fw-bold mb-0 text-danger">2</h3>
                </div>
            </div>
        </div>
    </div>

    <!-- MINI CALENDAR & BARANGAY OFFICIALS SIDE BY SIDE -->
    <div class="row g-4">
        <!-- MINI CALENDAR LEFT -->
        <div class="col-lg-6">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <div id="miniCalendar" style="max-width: 100%;"></div>
                </div>
            </div>
        </div>

        <!-- BARANGAY OFFICIALS RIGHT -->
        <div class="col-lg-6">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-body">
                    <h5 class="fw-bold text-secondary mb-3 text-center">Barangay Officials</h5>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item d-flex justify-content-between">
                            <span>SK Chairperson</span><strong>Juan Dela Cruz</strong>
                        </li>
                        <li class="list-group-item d-flex justify-content-between">
                            <span>SK Kagawad</span><strong>Maria Santos</strong>
                        </li>
                        <li class="list-group-item d-flex justify-content-between">
                            <span>Barangay Captain</span><strong>Roberto Reyes</strong>
                        </li>
                        <li class="list-group-item d-flex justify-content-between">
                            <span>Secretary</span><strong>Angela Bautista</strong>
                        </li>
                        <li class="list-group-item d-flex justify-content-between">
                            <span>Treasurer</span><strong>Mark dela Peña</strong>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- EVENT MODAL -->
<div class="modal fade" id="eventModal" tabindex="-1" aria-labelledby="eventModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border-0 shadow">
            <div class="modal-header bg-primary text-white">
                <h5 class="modal-title" id="eventModalLabel">Event Details</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <h5 id="eventTitle" class="fw-bold text-primary"></h5>
                <p id="eventDate" class="text-muted small mb-1"></p>
                <p id="eventDescription" class="text-dark"></p>
            </div>
        </div>
    </div>
</div>

<!-- SCRIPTS -->
@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.8/index.global.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            var calendarEl = document.getElementById('miniCalendar');

            var events = [
                { title: 'Youth Leadership Seminar', start: '2025-10-30', description: 'A leadership training for SK youth leaders.' },
                { title: 'Barangay Clean-Up Drive', start: '2025-11-10', description: 'A community clean-up and awareness event.' },
                { title: 'Sports Tournament', start: '2025-11-25', description: 'An inter-purok sports competition.' }
            ];

            var calendar = new FullCalendar.Calendar(calendarEl, {
                initialView: 'dayGridMonth',
                height: 350,
                contentHeight: 300,
                aspectRatio: 1.3,
                headerToolbar: { left: 'prev,next', center: 'title', right: '' },
                events: events,
                eventClick: function (info) {
                    var event = info.event;
                    document.getElementById('eventTitle').innerText = event.title;
                    document.getElementById('eventDate').innerText =
                        new Date(event.start).toLocaleDateString('en-US', {
                            weekday: 'long',
                            year: 'numeric',
                            month: 'long',
                            day: 'numeric'
                        });
                    document.getElementById('eventDescription').innerText = event.extendedProps.description;
                    new bootstrap.Modal(document.getElementById('eventModal')).show();
                }
            });
            calendar.render();
        });
    </script>
}
