@{
    Layout = "~/Views/Shared/_LayoutFederation.cshtml";
    ViewData["Title"] = "Compliance Monitoring";
}


<div class="container-fluid">

    <!-- PAGE HEADER -->
    <div class="mb-4">
        <h2 class="fw-bold">Compliance Monitoring</h2>
    </div>

    <!-- Filter Section -->
    <div class="row mb-3">
        <div class="col d-flex justify-content-end align-items-end gap-3 flex-wrap">
            <div class="col-md-auto">
                <select class="form-select">
                    <option selected disabled>Select document type</option>
                    <option>Meeting Minutes</option>
                    <option>Budget Proposals</option>
                    <option>Project Reports</option>
                </select>
            </div>

            <!-- Action Buttons -->
            <div class="mt-4 text-end">
                <button class="btn btn-primary me-2">
                    Generate Compliance Report
                </button>
                <button class="btn btn-secondary">
                    Send Reminder Notifications
                </button>
            </div>
        </div>
    </div>

    <!-- Compliance Table (simplified columns) -->
    <div class="card shadow-sm mb-4">
        <div class="card-header bg-success">
            <h5 class="mb-0 fw-bold text-white">Barangay Compliance Records</h5>
        </div>
        <div class="card-body">

            <div class="table-responsive">
                <table class="table table-striped table-bordered align-middle">
                    <thead class="table-light">
                        <tr>
                            <th>Barangay</th>
                            <th>Status</th>
                            <th>Last Submission</th>
                            <th class="text-center">Action</th>
                        </tr>
                    </thead>

                    <tbody>
                        @* Example row
                        <tr>
                            <td>@item.Barangay</td>
                            <td>@item.Status</td>
                            <td>@item.LastSubmission</td>
                            <td class="text-center">
                                <button class="btn btn-sm btn-primary btnViewRecord"
                                        data-id="@item.Id">
                                    <i class="bi bi-eye"></i> View
                                </button>
                            </td>
                        </tr>
                        *@
                    </tbody>
                </table>
            </div>
        </div>
    </div>

</div>

<!-- MODAL FOR VIEW/UPDATE RECORD -->
<div class="modal fade" id="complianceModal" tabindex="-1" aria-labelledby="complianceModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">

            <div class="modal-header">
                <h5 class="modal-title" id="complianceModalLabel">Compliance Details</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>

            <div class="modal-body">

                <form id="complianceForm">

                    <input type="hidden" id="recordId" />

                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label">Barangay</label>
                            <input type="text" class="form-control" id="barangay" readonly />
                        </div>

                        <div class="col-md-6">
                            <label class="form-label">Document</label>
                            <input type="text" class="form-control" id="document" readonly />
                        </div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-md-6">
                            <label class="form-label">Status</label>
                            <select id="status" class="form-select">
                                <option value="Compliant">Compliant</option>
                                <option value="Non-Compliant">Non-Compliant</option>
                                <option value="Pending">Pending</option>
                            </select>
                        </div>

                        <div class="col-md-6">
                            <label class="form-label">Last Submission</label>
                            <input type="date" class="form-control" id="lastSubmission" />
                        </div>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Remarks</label>
                        <textarea class="form-control" id="remarks" rows="3"></textarea>
                    </div>

                </form>

            </div>

            <div class="modal-footer">
                <button class="btn btn-primary" id="btnSaveRecord">Save Changes</button>
                <button class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>

        </div>
    </div>
</div>

<script>
    // Open modal when clicking view button
    document.addEventListener("click", function (e) {
        if (e.target.closest(".btnViewRecord")) {
            let id = e.target.closest(".btnViewRecord").dataset.id;
            let modal = new bootstrap.Modal(document.getElementById("complianceModal"));
            modal.show();
            // load data via AJAX if needed using id
        }
    });

    // Example hooks for top-action buttons (wire these to backend endpoints)
    document.getElementById("btnGenerateCompliance").addEventListener("click", function () {
        // TODO: trigger report generation
        console.log("Generate Compliance Report clicked");
    });

    document.getElementById("btnSendReminders").addEventListener("click", function () {
        // TODO: trigger reminder notifications
        console.log("Send Reminder Notifications clicked");
    });
</script>
